package com.backend.service;

import org.springframework.stereotype.Service;
import com.backend.controller.AppointmentController;
//import com.backend.entities.M
import com.backend.entities.AppointmentEntity;
import com.backend.entities.User;
import com.backend.repository.AppointmentRepository;
import com.backend.repository.MedicalRecordRepository;
import com.backend.repository.UserRepository;

import jakarta.mail.MessagingException;
import jakarta.transaction.Transactional;
import lombok.AllArgsConstructor;

@Service
@Transactional
@AllArgsConstructor
public class MedicalRecordEmailServiceImpl implements MedicalRecordEmailService {

	private final MedicalRecordRepository medicalRecordRepository;
	
	private final AppointmentRepository appointmentRepository;
	
	private final UserRepository userRepository;
	
	private final EmailService emailService;
	
	
	@Override
	public void sendRecordToPatientAndDoctor(Long id) {
		// TODO Auto-generated method stub
		
		 medicalRecordRepository.findById(id);
		 
		
//		AppointmentEntity appointmentEntity = appointmentRepository.findById(medicalRecord.getAppointment());
//		
//		
//		//Patient Email
//		User patientUser = userRepository.findById(appointmentEntity.getPatient().getId())
//													.orElseThrow();
//		
//		//Doctor Email
//		User doctorUser = userRepository.findById(appointmentEntity.getDoctor().getId())
//													.orElseThrow();
//		
//		String subject = "Medical Record Available â€“ " + medicalRecord.getFileName();
//
//        String emailBody =
//                "Hello,\n\n" +
//                "A medical record has been shared.\n\n" +
//                "Details:\n" +
//                "Patient: " + patientUser.getName() + "\n" +
//                "Doctor: " + doctorUser.getName() + "\n" +
//                "Record Type: " + medicalRecord.getRecordType() + "\n" +
//                "Status: COMPLETED\n\n" +
//                "Please find the attached file.\n\n" +
//                "Regards,\nHospital Admin";
//
//        // Send to patient
//        emailService.sendMedicalRecord(
//                patientUser.getEmail(),
//                subject,
//                emailBody,
//                medicalRecord.getFileData(),
//                medicalRecord.getFileName()
//        );
//
//        // Send to doctor
//        emailService.sendMedicalRecord(
//                doctorUser.getEmail(),
//                subject,
//                emailBody,
//                medicalRecord.getFileData(),
//                medicalRecord.getFileName()
//        );
	}

}
